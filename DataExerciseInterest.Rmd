---
title: "Data Exercise: What is the interest rate?"
author: "Manolis Chatzikonstantinou"
date: "29/7/2022"
output:
  pdf_document: default
  html_document: default
  word_document: default
---


# Interest rates

The level of interest rates is the main policy instrument of the Central Bank. The Federal Open Market Committee (FOMC) sets a target on the rate of federal funds, influencing all the rates of returns of fixed assets in the economy. Now, we check the behavior of the interest rate using data from online sources.

## Getting the data

We will download several series of data related to interest rates. For that reason, here, I introduce a new package  that makes easier the use of data provided by the Research division of the Federal Reserve Bank of St. Louis. The database has more than 500,000 economic time series from 87 sources, covering  inflation and employment measures, exchange rates, interest rates, monetary aggregates, U.S. trade, production and financial data.  The use of those data with R is made simpler with the fredr package. This package provides a complete set of R function to the [Federal Reserve Economic Data (FRED)](https://fred.stlouisfed.org/) RESTful API. For that reason you should set up an account in the website above and then get an API to use in your applications. 

After you do so install the package `install.packages('fred')` and start working with the data. As an example, let's find data about unemployment in the US. To do so, we will need to know the series ID in the data, however the package provides some functionality in case you do not know the key and you do not want to search directly in the website. The following code finds the most related series ID in the FRED data related to the term "unemployment" and plots the time series. Also, make sure to read the documentation `help("fredr")`.


```{r warning=FALSE}
library(tidyverse)
library(fredr)
fredr_set_key(Sys.getenv("FRED_API_KEY"))
fredr_series_search_text(
  search_text = "unemployment",
  order_by = "search_rank",
  sort_order = "desc",
  limit = 1) %>%
  pull(id) %>% 
  fredr(series_id = .) %>%
  ggplot(data = ., mapping = aes(x = date, y = value, color = series_id)) +
    geom_line() +
    labs(x = "Observation Date", y = "Rate", color = "Series")

```

For convenvience let's also define to function that downloads data from a specific starting date, at a monthly frequence, in levels ("lin") and in percent changes ("pc1").
```{r}
# Create a function to print squares of numbers in sequence.
fredr_levels_monthly <- function(name,ddate) {
fredr::fredr_series_observations(
  series_id = name,
  observation_start = as.Date(ddate),
  frequency = "m",
  units = "lin"
)
}

fredr_pcyearly_monthly <- function(name,ddate) {
fredr::fredr_series_observations(
  series_id = name,
  observation_start = as.Date(ddate),
  frequency = "m",
  units = "pc1"
)
}
```

## Fed Funds rate in the 21st century

This graph shows the federal funds rate for approximately the past 20 years, from 2000 to 2021
```{r, include=TRUE}

fredr_series_search_text(
  search_text = "fed funds rate",
  order_by = "search_rank",
  sort_order = "desc",
  limit = 1) %>%
  pull(id) %>% 
  fredr(series_id = .) %>% filter(date >= "1999-12-01" & date <= "2023-01-01") %>% 
  ggplot(data = ., mapping = aes(x = date, y = value)) +
    geom_line() + ggtitle("Fed Funds Rate") + 
  theme(plot.title = element_text(hjust = 0.5))+
    labs(x = "Observation Date", y = "Percent")

```

In the 2000s, you see the Fed following clear cycles for both tightening and loosening rates. To start the decade, the Fed slashed interest rates 13 times to a low of 1 percent, to deal with a recession generated by the drop in the stock market. Then, The U.S. central bank hiked interest rates 17 times between 2004 and 2006 to a high of 5.25 percent. That was until the financial crisis of 2008 happened and the ensuing Great Recession, The Fed then slashed interest rates by 100 basis points to near-zero. The interest rate couldn’t escape zero in the 2010s and until 2015 the policy rate was unchanged. After 2015, the Fed only hiked interest rates by 25 basis points once per year. That is, until 2017, when the Fed hiked three times, and 2018, when they hiked four more times. The fed funds rate peaked at 2.25-2.5 percent. The fed funds rate looked like it was about to settle there until the coronavirus pandemic came along, ushering back in another era of near-zero rates. The Fed slashed rates to zero in two emergency meetings within 13 days of each other as the gears of the economy came to a halt.

Observe that the same plot, would have been given easier if we know the name of the series, and use the function, we defined:

```{r, include=TRUE}

fredr_levels_monthly("FEDFUNDS","1999-12-01")%>% 
  ggplot(data = ., mapping = aes(x = date, y = value)) +
    geom_line() + ggtitle("Fed Funds Rate") + 
  theme(plot.title = element_text(hjust = 0.5))+
    labs(x = "Observation Date", y = "Percent")

```

### Fisher equation

Fisher equation is called the relationship between nominal and real interest rates, and the percentage change in the aggregate price level between two time periods, or else the inflation rate. If someone buys a 1 dollar-bond in period $t$ while the interest rate on the bond is $i_t$. In period $t+1$, the buyer will receive $1+i_t$ dollars. However, if the inflation rate from $t$ to $t+1$ is anticipated to be  $\pi_{t}$, then the present value of the proceeds from the bond is  $\frac{1+i_t}{1+\pi+{t+1}}$, which is equivalent to the return on the bond in real terms - the additional basket of goods that can be bought- at period $t+1$. This, real return on savings is termed real interest rate $r_{t}$ Hence,

\begin{equation}
1+r_{t} = \frac{1+i_t}{1+\pi_{t}}
\end{equation}

From here the nominal interest rate can be solved for.

\begin{align}
1 + i_t &= \left (1 + r_{t} \right ) \left (1 + \pi_{t} \right ) \\
        &= 1 + r_{t} + \pi_{t} + r_{t} \pi_{t}
\end{align}

Therefore,

\begin{align}
i_t &= r_{t} + \pi_{t} + r_{t} \pi_{t} \\
    &\approx r_{t} + \pi_{t}
\end{align}

The last equation follows when both the inflation rate and the nominal interest rates are small. For example, when both numbers are below 0.1 (or 10 percent), the value of $+ r_{t} \pi_{t}$ would necessarily be close to 0 (smaller than 0.01 or 1 percent).

### Second graph


Long-term economic forces are what move the normal level of __real__ interest rates. (In contrast, interest rates respond in the short term to economic fluctuations rather than trends.) So we’ve graphed three popular interest rates that have a longer time series: the 1-year Treasury bond rate, Moody’s Aaa corporate bond rate, and the federal funds rate. All those rates are nominal, so we transform them to real by substracting the rate of inflation.



```{r}

data<-bind_rows(fredr_levels_monthly("AAA",ddate = "1955-01-01"),
                fredr_levels_monthly("GS1",ddate = "1955-01-01"),
                fredr_levels_monthly("FEDFUNDS",ddate = "1955-01-01"),
                fredr_pcyearly_monthly("CPIAUCSL",ddate = "1955-01-01"))

data<-data %>% select(1,2,3) %>% pivot_wider(id_cols = "date", names_from =  series_id)
data<-data %>% mutate(AAAr=AAA-CPIAUCSL,GS1r=GS1-CPIAUCSL,FEDFUNDSr=FEDFUNDS-CPIAUCSL)



data %>% select(date,AAAr,GS1r,FEDFUNDSr) %>% pivot_longer(-date)%>% 
  ggplot(data = ., mapping = aes(x = date, y = value, color = name)) +
    geom_line() +
    labs(x = "Observation Date", y = "Rate", color = "Series")

```

